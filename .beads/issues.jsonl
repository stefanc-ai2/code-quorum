{"id":"claude_code_bridge-s7t","title":"Simplify CCB to Claude+Codex Only","description":"Simplify Claude Code Bridge from a 5-provider, multi-platform system to a minimal 2-provider (Claude + Codex) solution for **macOS + Linux only** (no Windows, no WSL).\n\n## Goals\n- Providers: keep **codex** + **claude** only; remove **gemini/opencode/droid**\n- Platform: remove Windows/WSL compatibility and Windows-specific artifacts\n- UX: replace `pend` with **reply-via-ask**; `ask` becomes **pure async** (submit-only)\n- Remove MCP delegation integration (`mcp/ccb-delegation`, `ccb droid setup-delegation`)\n- Keep both tmux + WezTerm backends\n\n## Notes\n- Keep repo green per-layer: `python -m compileall -q lib bin ccb` + targeted `pytest`.\n- No ‚Äúread results from logs‚Äù UX (no `pend`, no completion hook prompting `pend`).\n\n## Estimated reduction\n~4,500+ lines of code, 20+ files deleted (likely more once docs/tests/installers are pruned).\n","status":"open","priority":1,"issue_type":"epic","owner":"stefanc@allenai.org","created_at":"2026-01-30T12:38:16.250679-08:00","created_by":"stefanc-ai2","updated_at":"2026-01-30T13:21:39.237439-08:00","labels":["simplification"]}
{"id":"claude_code_bridge-s7t.1","title":"Delete Gemini provider files","description":"Remove all Gemini-related code from the codebase.\n\n## Files to DELETE\n- bin/gask, bin/gaskd, bin/gpend, bin/gping\n- lib/gaskd_daemon.py, lib/gaskd_protocol.py, lib/gaskd_session.py\n- lib/gemini_comm.py\n- lib/askd/adapters/gemini.py\n\n## Verification\n- pytest passes\n- No import errors","status":"closed","priority":1,"issue_type":"task","assignee":"stefanc-ai2","owner":"stefanc@allenai.org","created_at":"2026-01-30T12:38:48.333354-08:00","created_by":"stefanc-ai2","updated_at":"2026-01-30T14:39:10.449044-08:00","closed_at":"2026-01-30T14:39:10.449044-08:00","close_reason":"Deleted Gemini provider files","labels":["provider-removal","simplification"],"dependencies":[{"issue_id":"claude_code_bridge-s7t.1","depends_on_id":"claude_code_bridge-s7t","type":"parent-child","created_at":"2026-01-30T12:38:48.333922-08:00","created_by":"stefanc-ai2"},{"issue_id":"claude_code_bridge-s7t.1","depends_on_id":"claude_code_bridge-s7t.4","type":"blocks","created_at":"2026-01-30T13:25:55.427879-08:00","created_by":"stefanc-ai2"}]}
{"id":"claude_code_bridge-s7t.10","title":"Delete pend + completion hook","description":"Remove all `pend` UX and the completion hook machinery (since results are delivered via reply-via-ask).\n\n## Files to DELETE\n- `bin/pend`\n- `bin/cpend`\n- `bin/lpend`\n- `claude_skills/pend/` (entire directory)\n- `codex_skills/pend/` (entire directory)\n- `bin/ccb-completion-hook`\n- `lib/completion_hook.py`\n\n## Follow-ups\n- Remove imports/usages of completion hook from provider adapters.\n- Update any docs/tests that reference `pend` or hook output.\n\n## Verification\n- `pend codex` is gone (or replaced with a stub that explains migration)\n- No remaining references to `pend` in skills/docs (outside historical changelog files)\n","status":"closed","priority":1,"issue_type":"task","owner":"stefanc@allenai.org","created_at":"2026-01-30T12:40:29.777733-08:00","created_by":"stefanc-ai2","updated_at":"2026-01-30T18:28:26.666877-08:00","closed_at":"2026-01-30T18:28:26.666877-08:00","close_reason":"Removed pend UX and completion hook; updated installer/docs/tests.","labels":["async-ask","simplification"],"dependencies":[{"issue_id":"claude_code_bridge-s7t.10","depends_on_id":"claude_code_bridge-s7t","type":"parent-child","created_at":"2026-01-30T12:40:29.778315-08:00","created_by":"stefanc-ai2"},{"issue_id":"claude_code_bridge-s7t.10","depends_on_id":"claude_code_bridge-s7t.9","type":"blocks","created_at":"2026-01-30T12:40:34.204308-08:00","created_by":"stefanc-ai2"},{"issue_id":"claude_code_bridge-s7t.10","depends_on_id":"claude_code_bridge-s7t.11","type":"blocks","created_at":"2026-01-30T13:26:21.694163-08:00","created_by":"stefanc-ai2"},{"issue_id":"claude_code_bridge-s7t.10","depends_on_id":"claude_code_bridge-s7t.19","type":"blocks","created_at":"2026-01-30T16:23:35.523666-08:00","created_by":"stefanc-ai2"},{"issue_id":"claude_code_bridge-s7t.10","depends_on_id":"claude_code_bridge-s7t.20","type":"blocks","created_at":"2026-01-30T16:23:35.763822-08:00","created_by":"stefanc-ai2"},{"issue_id":"claude_code_bridge-s7t.10","depends_on_id":"claude_code_bridge-s7t.21","type":"blocks","created_at":"2026-01-30T16:23:36.01138-08:00","created_by":"stefanc-ai2"}]}
{"id":"claude_code_bridge-s7t.11","title":"Update ask skills for bidirectional reply-via-ask","description":"Update the *ask* skills/docs (Claude + Codex) to match the new model:\n- `ask` is send-only (direct pane send), always async\n- replies arrive via reply-via-ask (`--reply-to`) with `CCB_REPLY` / `CCB_FROM`\n- no `pend`\n- no daemon prerequisites (`askd`/`caskd`/`laskd`)\n- no MCP references\n\n## Files to MODIFY\n- `claude_skills/ask/SKILL.md`\n  - Document: how to send work to Codex via `ask codex ...`\n  - Document: how to receive a request (find `CCB_REQ_ID`) and reply via:\n    - `ask claude --reply-to=\u003creq_id\u003e --no-wrap \"...\"` (when Codex is responding)\n  - Remove any mention of `pend`, `askd`, MCP, or log-monitoring.\n- `codex_skills/ask/SKILL.md`\n  - Mirror: how Codex receives `CCB_REQ_ID` and replies via:\n    - `ask codex --reply-to=\u003creq_id\u003e --no-wrap \"...\"` (when Claude is responding)\n\n## Verification\n- Skills no longer mention `pend`/`askd`/`caskd`/`laskd` or MCP\n- Instructions explicitly require reply-via-ask (`--reply-to`) and `--no-wrap` for result payloads\n\nDEPENDS ON\n  ‚Üí ‚óã claude_code_bridge-s7t.8: Add --reply-to flag and response markers to protocol\n","status":"closed","priority":1,"issue_type":"task","assignee":"stefanc-ai2","owner":"stefanc@allenai.org","created_at":"2026-01-30T12:40:41.788857-08:00","created_by":"stefanc-ai2","updated_at":"2026-01-30T16:43:49.919298-08:00","closed_at":"2026-01-30T16:43:49.919298-08:00","close_reason":"Updated ask skills for send-only ask and reply-via-ask","labels":["async-ask","simplification"],"dependencies":[{"issue_id":"claude_code_bridge-s7t.11","depends_on_id":"claude_code_bridge-s7t","type":"parent-child","created_at":"2026-01-30T12:40:41.78939-08:00","created_by":"stefanc-ai2"},{"issue_id":"claude_code_bridge-s7t.11","depends_on_id":"claude_code_bridge-s7t.8","type":"blocks","created_at":"2026-01-30T12:40:47.562154-08:00","created_by":"stefanc-ai2"}]}
{"id":"claude_code_bridge-s7t.12","title":"Consolidate session registries (optional)","description":"Merge multiple registry files into a single unified session registry.\n\n## Files to MERGE\n- lib/pane_registry.py (363 lines)\n- lib/laskd_registry.py (659 lines)\n- lib/claude_session_resolver.py (358 lines)\n\nInto: lib/session_registry.py (~400 lines)\n\n## Verification\n- All existing tests pass\n- Session resolution works correctly for both Claude and Codex","status":"open","priority":3,"issue_type":"task","owner":"stefanc@allenai.org","created_at":"2026-01-30T12:40:54.429633-08:00","created_by":"stefanc-ai2","updated_at":"2026-01-30T12:40:54.429633-08:00","labels":["optional","refactor","simplification"],"dependencies":[{"issue_id":"claude_code_bridge-s7t.12","depends_on_id":"claude_code_bridge-s7t","type":"parent-child","created_at":"2026-01-30T12:40:54.430197-08:00","created_by":"stefanc-ai2"},{"issue_id":"claude_code_bridge-s7t.12","depends_on_id":"claude_code_bridge-s7t.11","type":"blocks","created_at":"2026-01-30T12:41:00.06643-08:00","created_by":"stefanc-ai2"},{"issue_id":"claude_code_bridge-s7t.12","depends_on_id":"claude_code_bridge-s7t.6","type":"blocks","created_at":"2026-01-30T12:41:00.250239-08:00","created_by":"stefanc-ai2"}]}
{"id":"claude_code_bridge-s7t.13","title":"Remove MCP integration","description":"Remove MCP delegation integration entirely (out of scope for the simplified repo).\n\n## Files to DELETE / MODIFY (minimum)\n- Delete: `mcp/` (entire directory)\n- Modify: `ccb`\n  - Remove `ccb droid setup-delegation` and `ccb droid test-delegation`\n  - Remove any setup hints that reference delegation\n- Modify: `install.sh`\n  - Remove droid MCP auto-install blocks (add/remove ccb-delegation)\n- Modify: `README.md` / `README_zh.md`\n  - Remove references to MCP delegation setup\n- Consider deleting or archiving: `plans/droid-delegation-skills-plan.md`\n\n## Verification\n- `rg -n \"ccb-delegation|setup-delegation\" -S` finds nothing (outside historical changelog files)\n","status":"closed","priority":2,"issue_type":"task","assignee":"stefanc-ai2","owner":"stefanc@allenai.org","created_at":"2026-01-30T13:23:31.168789-08:00","created_by":"stefanc-ai2","updated_at":"2026-01-30T14:55:52.618306-08:00","closed_at":"2026-01-30T14:55:52.618306-08:00","close_reason":"Removed MCP delegation server, installer hooks, and CLI references.","labels":["mcp-removal","simplification"],"dependencies":[{"issue_id":"claude_code_bridge-s7t.13","depends_on_id":"claude_code_bridge-s7t","type":"parent-child","created_at":"2026-01-30T13:23:46.052354-08:00","created_by":"stefanc-ai2"},{"issue_id":"claude_code_bridge-s7t.13","depends_on_id":"claude_code_bridge-s7t.3","type":"blocks","created_at":"2026-01-30T13:26:26.960079-08:00","created_by":"stefanc-ai2"}]}
{"id":"claude_code_bridge-s7t.14","title":"Update docs/README/CLAUDE.md","description":"Update all user-facing docs to match the simplified scope:\n- Providers: only `codex` + `claude`\n- Platform: macOS/Linux only (no Windows/WSL)\n- UX: no `pend`; reply-via-ask (`--reply-to`)\n- No MCP delegation tooling\n\n## Files to MODIFY (minimum)\n- `README.md`\n- `README_zh.md`\n- `CLAUDE.md`\n- `CHANGELOG.md` (add an Unreleased entry for the breaking changes)\n\n## Verification\n- `rg -n \"\\b(gemini|opencode|droid)\\b\" README.md README_zh.md CLAUDE.md` returns nothing\n- `rg -n \"\\bpend\\b\" README.md README_zh.md CLAUDE.md` returns nothing\n- `rg -n \"ccb-delegation|setup-delegation\" README.md README_zh.md` returns nothing\n","notes":"Add explicit removal of any docs/design language suggesting log-tail monitoring for results; document that results arrive in-pane / reply-via-ask only.","status":"open","priority":2,"issue_type":"task","owner":"stefanc@allenai.org","created_at":"2026-01-30T13:23:58.800201-08:00","created_by":"stefanc-ai2","updated_at":"2026-01-30T13:48:54.170274-08:00","labels":["docs","simplification"],"dependencies":[{"issue_id":"claude_code_bridge-s7t.14","depends_on_id":"claude_code_bridge-s7t","type":"parent-child","created_at":"2026-01-30T13:24:07.17897-08:00","created_by":"stefanc-ai2"},{"issue_id":"claude_code_bridge-s7t.14","depends_on_id":"claude_code_bridge-s7t.4","type":"blocks","created_at":"2026-01-30T13:26:32.220855-08:00","created_by":"stefanc-ai2"},{"issue_id":"claude_code_bridge-s7t.14","depends_on_id":"claude_code_bridge-s7t.7","type":"blocks","created_at":"2026-01-30T13:26:37.495365-08:00","created_by":"stefanc-ai2"},{"issue_id":"claude_code_bridge-s7t.14","depends_on_id":"claude_code_bridge-s7t.10","type":"blocks","created_at":"2026-01-30T13:26:42.758132-08:00","created_by":"stefanc-ai2"},{"issue_id":"claude_code_bridge-s7t.14","depends_on_id":"claude_code_bridge-s7t.13","type":"blocks","created_at":"2026-01-30T13:26:48.040755-08:00","created_by":"stefanc-ai2"}]}
{"id":"claude_code_bridge-s7t.15","title":"Update/delete tests + system scripts","description":"Update the test suite to match the simplified scope (2 providers, Unix-only, no pend, no MCP).\n\n## Expected changes\n- Delete provider-specific tests for removed providers (Gemini/OpenCode/Droid).\n- Delete or refactor system scripts that exercise removed providers and/or `pend`.\n- Update any tests that enumerate provider lists or assume Windows/WSL.\n\n## Likely targets\n- Provider tests: `test/test_gaskd_session_ensure_pane.py`, `test/test_oaskd_session.py`, droid-related tests\n- System scripts: `test/system_ccb_daemon.sh`, `test/system_pend_isolation.sh`, `test/system_comm_matrix.sh`\n\n## Verification\n- `pytest test/ -v --tb=short` passes on macOS/Linux\n","status":"closed","priority":2,"issue_type":"task","owner":"stefanc@allenai.org","created_at":"2026-01-30T13:24:18.853718-08:00","created_by":"stefanc-ai2","updated_at":"2026-01-30T19:17:52.795454-08:00","closed_at":"2026-01-30T19:17:52.795454-08:00","close_reason":"Deleted obsolete system scripts tied to removed providers/daemons/pend; pytest passes","labels":["simplification","tests"],"dependencies":[{"issue_id":"claude_code_bridge-s7t.15","depends_on_id":"claude_code_bridge-s7t","type":"parent-child","created_at":"2026-01-30T13:24:27.317771-08:00","created_by":"stefanc-ai2"},{"issue_id":"claude_code_bridge-s7t.15","depends_on_id":"claude_code_bridge-s7t.1","type":"blocks","created_at":"2026-01-30T13:26:53.314273-08:00","created_by":"stefanc-ai2"},{"issue_id":"claude_code_bridge-s7t.15","depends_on_id":"claude_code_bridge-s7t.2","type":"blocks","created_at":"2026-01-30T13:26:58.613484-08:00","created_by":"stefanc-ai2"},{"issue_id":"claude_code_bridge-s7t.15","depends_on_id":"claude_code_bridge-s7t.3","type":"blocks","created_at":"2026-01-30T13:27:03.863378-08:00","created_by":"stefanc-ai2"},{"issue_id":"claude_code_bridge-s7t.15","depends_on_id":"claude_code_bridge-s7t.6","type":"blocks","created_at":"2026-01-30T13:27:09.130649-08:00","created_by":"stefanc-ai2"},{"issue_id":"claude_code_bridge-s7t.15","depends_on_id":"claude_code_bridge-s7t.10","type":"blocks","created_at":"2026-01-30T13:27:14.393033-08:00","created_by":"stefanc-ai2"}]}
{"id":"claude_code_bridge-s7t.16","title":"Simplify install.sh (Unix-only)","description":"Simplify `install.sh` for Unix-only and 2-provider scope.\n\n## Goals\n- Only install/link commands that remain (`ccb`, `ask`, `ping`, `askd`, and any codex/claude shims you keep).\n- Remove WSL/Windows prompts and checks.\n- Remove MCP delegation install/remove logic.\n- Stop linking `pend` and completion-hook scripts.\n\n## Files to MODIFY\n- `install.sh`\n\n## Verification\n- Fresh install produces a minimal working toolset for codex+claude.\n- `rg -n \"mcp|droid mcp|setup-delegation\" install.sh` returns nothing.\n","status":"open","priority":2,"issue_type":"task","owner":"stefanc@allenai.org","created_at":"2026-01-30T13:24:39.192637-08:00","created_by":"stefanc-ai2","updated_at":"2026-01-30T13:24:39.192637-08:00","labels":["install","simplification"],"dependencies":[{"issue_id":"claude_code_bridge-s7t.16","depends_on_id":"claude_code_bridge-s7t","type":"parent-child","created_at":"2026-01-30T13:24:47.4078-08:00","created_by":"stefanc-ai2"},{"issue_id":"claude_code_bridge-s7t.16","depends_on_id":"claude_code_bridge-s7t.1","type":"blocks","created_at":"2026-01-30T13:27:19.68978-08:00","created_by":"stefanc-ai2"},{"issue_id":"claude_code_bridge-s7t.16","depends_on_id":"claude_code_bridge-s7t.2","type":"blocks","created_at":"2026-01-30T13:27:24.997973-08:00","created_by":"stefanc-ai2"},{"issue_id":"claude_code_bridge-s7t.16","depends_on_id":"claude_code_bridge-s7t.3","type":"blocks","created_at":"2026-01-30T13:27:30.292864-08:00","created_by":"stefanc-ai2"},{"issue_id":"claude_code_bridge-s7t.16","depends_on_id":"claude_code_bridge-s7t.7","type":"blocks","created_at":"2026-01-30T13:27:35.591349-08:00","created_by":"stefanc-ai2"},{"issue_id":"claude_code_bridge-s7t.16","depends_on_id":"claude_code_bridge-s7t.10","type":"blocks","created_at":"2026-01-30T13:27:40.915431-08:00","created_by":"stefanc-ai2"},{"issue_id":"claude_code_bridge-s7t.16","depends_on_id":"claude_code_bridge-s7t.13","type":"blocks","created_at":"2026-01-30T13:27:46.217563-08:00","created_by":"stefanc-ai2"}]}
{"id":"claude_code_bridge-s7t.17","title":"Delete askd (unified daemon)","description":"Delete the unified `askd` daemon and all supporting code after `ask` no longer uses any daemon.\n\nGoal: reduce code footprint and remove daemon maintenance surface.\n\n## Files to DELETE (minimum)\n- `bin/askd`\n- `lib/askd/` (entire package)\n- `lib/askd_rpc.py`\n- `lib/askd_server.py`\n- `lib/askd_runtime.py`\n\n## Also update/remove\n- `bin/ccb-mounted`: remove unified-askd ping logic\n- `docs/` / skills / README: remove references to `askd`\n\n## Verification\n- `python -m compileall -q lib bin ccb test`\n- `python -m pytest test/ -q --tb=short`\n- `rg -n \"\\baskd\\b\" bin lib ccb` has no functional references (allow historical changelogs)\n","status":"closed","priority":1,"issue_type":"task","owner":"stefanc@allenai.org","created_at":"2026-01-30T16:16:13.667723-08:00","created_by":"stefanc-ai2","updated_at":"2026-01-30T19:08:21.947584-08:00","closed_at":"2026-01-30T19:08:21.947584-08:00","close_reason":"Deleted askd daemon + supporting modules; removed daemon autostart/shutdown in ccb; removed daemon-only tests","labels":["async-ask","simplification"],"dependencies":[{"issue_id":"claude_code_bridge-s7t.17","depends_on_id":"claude_code_bridge-s7t","type":"parent-child","created_at":"2026-01-30T16:16:17.433243-08:00","created_by":"stefanc-ai2"},{"issue_id":"claude_code_bridge-s7t.17","depends_on_id":"claude_code_bridge-s7t.9","type":"blocks","created_at":"2026-01-30T16:16:24.86886-08:00","created_by":"stefanc-ai2"}]}
{"id":"claude_code_bridge-s7t.18","title":"Remove cask/lask and caskd/laskd","description":"Remove legacy provider-specific CLIs and daemons now that `ask` is the only supported interface and sends directly to panes.\n\nGoal: reduce code footprint and remove redundant/legacy entrypoints.\n\n## Files to DELETE (minimum)\n- `bin/cask`\n- `bin/lask`\n- `bin/caskd`\n- `bin/laskd`\n- `lib/caskd_daemon.py`\n- `lib/laskd_daemon.py`\n\n## Notes\n- Keep session/protocol helpers that are still needed for direct-send `ask` (rename later if desired).\n\n## Verification\n- `python -m compileall -q lib bin ccb test`\n- `python -m pytest test/ -q --tb=short`\n- `rg -n \"\\b(cask|lask|caskd|laskd)\\b\" bin lib ccb` has no functional references (allow historical changelogs)\n","status":"closed","priority":1,"issue_type":"task","owner":"stefanc@allenai.org","created_at":"2026-01-30T16:16:48.316888-08:00","created_by":"stefanc-ai2","updated_at":"2026-01-30T18:51:08.849235-08:00","closed_at":"2026-01-30T18:51:08.849235-08:00","close_reason":"Deleted cask/lask + caskd/laskd CLIs/daemons; updated installer strings; removed daemon-only tests","labels":["simplification"],"dependencies":[{"issue_id":"claude_code_bridge-s7t.18","depends_on_id":"claude_code_bridge-s7t","type":"parent-child","created_at":"2026-01-30T16:16:51.734798-08:00","created_by":"stefanc-ai2"},{"issue_id":"claude_code_bridge-s7t.18","depends_on_id":"claude_code_bridge-s7t.9","type":"blocks","created_at":"2026-01-30T16:16:54.801589-08:00","created_by":"stefanc-ai2"}]}
{"id":"claude_code_bridge-s7t.19","title":"Update all-plan flow (no pend, reply-via-ask)","description":"Make the `all-plan` skill work in the daemonless, bidirectional-ask model.\n\nGoal: `all-plan` can broadcast planning prompts to mounted providers and receive their designs back via reply-via-ask, without `pend` or any daemons.\n\n## Key behavior changes\n- Detect mounted providers via `ccb-mounted` (no daemon ping assumptions).\n- Dispatch to providers via `ask \u003cprovider\u003e ...`.\n- Each respondent returns their design via:\n  - `ask \u003cdriver\u003e --reply-to=\u003creq_id\u003e --no-wrap \"...\"`\n- Collection becomes multi-turn (driver continues once replies arrive in-pane), not `pend` polling.\n\n## Files to MODIFY\n- `claude_skills/all-plan/SKILL.md`\n- `claude_skills/all-plan/references/flow.md`\n- `codex_skills/all-plan/SKILL.md`\n- `codex_skills/all-plan/references/flow.md`\n\n## Verification\n- Flow docs contain no references to `pend`, `askd`, `cask`, `lask`, or log-monitoring\n- Prompts instruct respondents to reply via `ask ... --reply-to=... --no-wrap`\n\nDEPENDS ON\n  ‚Üí ‚óã claude_code_bridge-s7t.8: Add --reply-to flag and response markers to protocol\n","status":"closed","priority":1,"issue_type":"task","assignee":"stefanc-ai2","owner":"stefanc@allenai.org","created_at":"2026-01-30T16:22:53.376397-08:00","created_by":"stefanc-ai2","updated_at":"2026-01-30T16:49:02.075326-08:00","closed_at":"2026-01-30T16:49:02.075326-08:00","close_reason":"Updated all-plan skill to dispatch/collect via ask and reply-via-ask","labels":["async-ask","simplification"],"dependencies":[{"issue_id":"claude_code_bridge-s7t.19","depends_on_id":"claude_code_bridge-s7t","type":"parent-child","created_at":"2026-01-30T16:22:56.186014-08:00","created_by":"stefanc-ai2"},{"issue_id":"claude_code_bridge-s7t.19","depends_on_id":"claude_code_bridge-s7t.8","type":"blocks","created_at":"2026-01-30T16:23:34.802578-08:00","created_by":"stefanc-ai2"}]}
{"id":"claude_code_bridge-s7t.2","title":"Delete OpenCode provider files","description":"Remove all OpenCode-related code from the codebase.\n\n## Files to DELETE\n- bin/oask, bin/oaskd, bin/opend, bin/oping\n- lib/oaskd_daemon.py, lib/oaskd_protocol.py, lib/oaskd_session.py\n- lib/opencode_comm.py\n- lib/askd/adapters/opencode.py\n\n## Verification\n- pytest passes\n- No import errors","status":"closed","priority":1,"issue_type":"task","assignee":"stefanc-ai2","owner":"stefanc@allenai.org","created_at":"2026-01-30T12:38:53.924659-08:00","created_by":"stefanc-ai2","updated_at":"2026-01-30T14:42:41.485955-08:00","closed_at":"2026-01-30T14:42:41.485955-08:00","close_reason":"Deleted OpenCode provider files","labels":["provider-removal","simplification"],"dependencies":[{"issue_id":"claude_code_bridge-s7t.2","depends_on_id":"claude_code_bridge-s7t","type":"parent-child","created_at":"2026-01-30T12:38:53.925226-08:00","created_by":"stefanc-ai2"},{"issue_id":"claude_code_bridge-s7t.2","depends_on_id":"claude_code_bridge-s7t.4","type":"blocks","created_at":"2026-01-30T13:26:00.672329-08:00","created_by":"stefanc-ai2"}]}
{"id":"claude_code_bridge-s7t.20","title":"Update pair flow (no pend, reply-via-ask)","description":"Make the `pair` skill work in the daemonless, bidirectional-ask model.\n\nGoal: reviewers respond via reply-via-ask (no `pend`), and the driver can proceed without blocking.\n\n## Key behavior changes\n- Step 3 (Review request): still uses `ask \u003cprovider\u003e ...`.\n- Step 4 (Collect feedback): replace `pend` with multi-turn collection:\n  - reviewer replies via `ask \u003cdriver\u003e --reply-to=\u003creq_id\u003e --no-wrap \"...\"`\n  - driver merges feedback once messages arrive in-pane.\n- Remove any references to daemons (`askd`, `caskd`, `laskd`) and any log-tail mechanics.\n\n## Files to MODIFY\n- `claude_skills/pair/SKILL.md`\n- `claude_skills/pair/references/flow.md`\n- `codex_skills/pair/SKILL.md`\n- `codex_skills/pair/references/flow.md`\n\n## Verification\n- Flow docs contain no references to `pend`, `askd`, `cask`, `lask`, or log-monitoring\n- Review prompt templates instruct reviewers to reply via `ask ... --reply-to=... --no-wrap`\n\nDEPENDS ON\n  ‚Üí ‚óã claude_code_bridge-s7t.8: Add --reply-to flag and response markers to protocol\n","status":"closed","priority":1,"issue_type":"task","assignee":"stefanc-ai2","owner":"stefanc@allenai.org","created_at":"2026-01-30T16:23:04.43951-08:00","created_by":"stefanc-ai2","updated_at":"2026-01-30T16:55:32.535383-08:00","closed_at":"2026-01-30T16:55:32.535383-08:00","close_reason":"Pair flow updated to use ask + reply-via-ask (no pend).","labels":["async-ask","simplification"],"dependencies":[{"issue_id":"claude_code_bridge-s7t.20","depends_on_id":"claude_code_bridge-s7t","type":"parent-child","created_at":"2026-01-30T16:23:07.557229-08:00","created_by":"stefanc-ai2"},{"issue_id":"claude_code_bridge-s7t.20","depends_on_id":"claude_code_bridge-s7t.8","type":"blocks","created_at":"2026-01-30T16:23:35.06632-08:00","created_by":"stefanc-ai2"}]}
{"id":"claude_code_bridge-s7t.21","title":"Update poll flow (no pend, reply-via-ask)","description":"Make the `poll` skill work in the daemonless, bidirectional-ask model.\n\nGoal: broadcast a question to mounted providers and receive responses back via reply-via-ask, without `pend` or any daemons.\n\n## Key behavior changes\n- Dispatch: `ask \u003cprovider\u003e ...` as before.\n- Collection: replace `pend` with multi-turn collection:\n  - respondent replies via `ask \u003cdriver\u003e --reply-to=\u003creq_id\u003e --no-wrap \"...\"`\n  - driver synthesizes once responses arrive in-pane.\n- Remove any references to daemon prerequisites or log-monitoring.\n\n## Files to MODIFY\n- `claude_skills/poll/SKILL.md`\n- `claude_skills/poll/references/flow.md`\n- `codex_skills/poll/SKILL.md`\n- `codex_skills/poll/references/flow.md`\n\n## Verification\n- Flow docs contain no references to `pend`, `askd`, `cask`, `lask`, or log-monitoring\n- Prompt templates instruct respondents to reply via `ask ... --reply-to=... --no-wrap`\n\nDEPENDS ON\n  ‚Üí ‚óã claude_code_bridge-s7t.8: Add --reply-to flag and response markers to protocol\n","status":"closed","priority":1,"issue_type":"task","owner":"stefanc@allenai.org","created_at":"2026-01-30T16:23:17.335367-08:00","created_by":"stefanc-ai2","updated_at":"2026-01-30T16:58:30.588928-08:00","closed_at":"2026-01-30T16:58:30.588928-08:00","close_reason":"Poll flow updated to use ask + reply-via-ask (no pend).","labels":["async-ask","simplification"],"dependencies":[{"issue_id":"claude_code_bridge-s7t.21","depends_on_id":"claude_code_bridge-s7t","type":"parent-child","created_at":"2026-01-30T16:23:20.00338-08:00","created_by":"stefanc-ai2"},{"issue_id":"claude_code_bridge-s7t.21","depends_on_id":"claude_code_bridge-s7t.8","type":"blocks","created_at":"2026-01-30T16:23:35.293193-08:00","created_by":"stefanc-ai2"}]}
{"id":"claude_code_bridge-s7t.22","title":"Ensure per-project session isolation (repo A vs repo B)","description":"Ensure CCB maintains strict per-project session isolation when multiple repos are active simultaneously.\n\nUser scenario:\n- Repo A: `claude` + `codex` sessions\n- Repo B: `claude` + `codex` sessions\n- Commands run inside repo A must talk only to repo A sessions, never repo B (and vice-versa).\n\n## Requirements\n- Default behavior: strict project isolation via `.ccb_config/` anchor.\n- Cross-project routing must remain opt-in only:\n  - explicit `--session-file` / `CCB_SESSION_FILE`, or\n  - `CCB_ALLOW_CROSS_PROJECT_SESSION=1`\n\n## Implementation notes\n- Preserve/verify `claude_session_resolver.resolve_claude_session()` filters registry lookups by `ccb_project_id` when strict_project.\n- Ensure the new direct-send `ask` path (s7t.9) resolves sessions *only* for the current project, and errors out if no `.ccb_config` anchor exists.\n\n## Tests\nAdd tests that set up two fake projects with different `.ccb_config` roots and registry records, and verify:\n- In project A, resolution never returns project B even if `CODEX_SESSION_ID`/`CCB_SESSION_ID` env vars point to B.\n- In project B, likewise.\n\n## Verification\n- `python -m pytest test/ -q --tb=short`\n- Manual: run two repos in parallel; `ask` from each repo routes to the correct local panes.\n\nDEPENDS ON\n  ‚Üí ‚óã claude_code_bridge-s7t.9: Make ask direct-send (no daemon / no polling)\n","status":"closed","priority":1,"issue_type":"task","owner":"stefanc@allenai.org","created_at":"2026-01-30T16:27:59.884093-08:00","created_by":"stefanc-ai2","updated_at":"2026-01-30T17:03:57.32968-08:00","closed_at":"2026-01-30T17:03:57.32968-08:00","close_reason":"Added tests ensuring claude/codex sessions remain project-isolated by default (repo A vs repo B).","labels":["async-ask","simplification"],"dependencies":[{"issue_id":"claude_code_bridge-s7t.22","depends_on_id":"claude_code_bridge-s7t","type":"parent-child","created_at":"2026-01-30T16:28:02.772973-08:00","created_by":"stefanc-ai2"}]}
{"id":"claude_code_bridge-s7t.23","title":"Audit all files for post-simplification relevance","status":"open","priority":2,"issue_type":"task","owner":"stefanc@allenai.org","created_at":"2026-01-30T18:19:16.667233-08:00","created_by":"stefanc-ai2","updated_at":"2026-01-30T18:19:16.667233-08:00","labels":["cleanup","simplification"],"dependencies":[{"issue_id":"claude_code_bridge-s7t.23","depends_on_id":"claude_code_bridge-s7t","type":"parent-child","created_at":"2026-01-30T18:19:16.66789-08:00","created_by":"stefanc-ai2"}]}
{"id":"claude_code_bridge-s7t.24","title":"Audit all files for post-simplification relevance","description":"Review every file in the repo to determine if it's still useful considering the new direct `ask` mechanism (no daemon, no pend, direct pane-to-pane via terminal.py).\n\n## Guiding Questions\nFor each file, ask:\n1. Is this file used by the simplified `ask` path (direct send via terminal backend)?\n2. Is this file used by `ccb` launcher or session management?\n3. Is this file dead code left over from the daemon/pend/multi-provider era?\n\n## Likely candidates for deletion\n- Daemon infrastructure: `lib/askd/`, `lib/askd_*.py`, `lib/*_daemon.py`\n- Log readers/pollers: `lib/*_comm.py` (CodexLogReader, ClaudeLogReader)\n- Provider-specific CLIs: `bin/cask`, `bin/lask`, `bin/caskd`, `bin/laskd`\n- Completion hook: `lib/completion_hook.py`, `bin/ccb-completion-hook`\n- Pend infrastructure: `bin/pend`, `bin/cpend`, `bin/lpend`\n- Worker pools: `lib/worker_pool.py`\n- RPC: `lib/askd_rpc.py`, `lib/askd_server.py`, `lib/askd_client.py`\n\n## Verification\n- `python -m compileall -q lib bin ccb`\n- `pytest test/ -v --tb=short`\n- Manual: `ccb codex,claude` + `ask codex \"test\"` + reply-via-ask still works\n\n## Notes\n- This is a sweep task; some files may be covered by existing s7t tickets (s7t.10, s7t.17, s7t.18)\n- Focus on files NOT covered by those tickets\n- Document deletions in commit messages","status":"open","priority":2,"issue_type":"task","owner":"stefanc@allenai.org","created_at":"2026-01-30T18:19:32.757986-08:00","created_by":"stefanc-ai2","updated_at":"2026-01-30T18:19:32.757986-08:00","labels":["cleanup","simplification"],"dependencies":[{"issue_id":"claude_code_bridge-s7t.24","depends_on_id":"claude_code_bridge-s7t","type":"parent-child","created_at":"2026-01-30T18:19:32.75995-08:00","created_by":"stefanc-ai2"}]}
{"id":"claude_code_bridge-s7t.25","title":"Delete assets/, docs/, and README_zh.md","description":"Remove outdated/unnecessary documentation artifacts.\n\n## Files to DELETE\n- `assets/` - Demo images/GIFs (outdated, reference removed providers)\n- `docs/` - Design docs (outdated architecture references)\n- `README_zh.md` - Chinese README (already deleted; references removed providers/Windows/pend)\n\n## Notes\n- README_zh.md was already deleted in this session\n- Main README.md needs updating separately (s7t.14)\n\n## Verification\n- `ls assets/ docs/ README_zh.md` should all fail\n- No broken image/doc links in remaining files","status":"closed","priority":2,"issue_type":"task","owner":"stefanc@allenai.org","created_at":"2026-01-30T18:25:16.026542-08:00","created_by":"stefanc-ai2","updated_at":"2026-01-30T18:37:47.281729-08:00","closed_at":"2026-01-30T18:37:47.281729-08:00","close_reason":"Deleted assets/, docs/, and README_zh.md; removed references; tests pass","labels":["cleanup","simplification"],"dependencies":[{"issue_id":"claude_code_bridge-s7t.25","depends_on_id":"claude_code_bridge-s7t","type":"parent-child","created_at":"2026-01-30T18:25:16.027308-08:00","created_by":"stefanc-ai2"}]}
{"id":"claude_code_bridge-s7t.26","title":"Consider moving to new repo with new name","description":"The simplified codebase is now so different from the original claude_code_bridge that it may warrant a fresh repo with a new name.\n\n## Rationale\n- Original: 5 providers (Claude/Codex/Gemini/OpenCode/Droid), Windows/WSL, daemon-based, pend polling\n- Simplified: 2 providers (Claude/Codex), macOS/Linux only, direct pane-to-pane, reply-via-ask\n\n## Options to consider\n1. **New repo**: Fresh start, clean history, new name (e.g., `ccb-lite`, `pane-bridge`, `ai-pane`)\n2. **Major version bump**: Stay in same repo, bump to v6.0.0 with breaking changes documented\n3. **Fork**: Fork the simplified version to a new repo, keep original for legacy users\n\n## Decision factors\n- Upstream compatibility (is this a fork of bfly123/claude_code_bridge?)\n- User migration path\n- Git history value vs. noise\n\n## Notes\n- Low priority; complete simplification first, then decide on packaging","status":"open","priority":3,"issue_type":"task","owner":"stefanc@allenai.org","created_at":"2026-01-30T18:27:00.27037-08:00","created_by":"stefanc-ai2","updated_at":"2026-01-30T18:27:00.27037-08:00","labels":["simplification"],"dependencies":[{"issue_id":"claude_code_bridge-s7t.26","depends_on_id":"claude_code_bridge-s7t","type":"parent-child","created_at":"2026-01-30T18:27:00.271731-08:00","created_by":"stefanc-ai2"}]}
{"id":"claude_code_bridge-s7t.27","title":"Investigate consolidating claude_skills/ and codex_skills/","description":"Determine if claude_skills/ and codex_skills/ can be merged into a single skills/ directory with templating.\n\n## Current state\n- **claude_skills/**: all-plan, ask, autonew, mounted, pair, pend (empty), ping, poll\n- **codex_skills/**: all-plan, ask, mounted, pair, pend (empty), ping, poll\n\n## Observations\n1. **Near-identical content**: Skills like `ask` differ only in:\n   - `CCB_CALLER=claude` vs `CCB_CALLER=codex`\n   - \"reply back to Codex\" vs \"reply back to Claude\"\n   \n2. **autonew**: Only in claude_skills, references removed providers (gemini, opencode, droid). \n   - Q: Is autonew needed at all? It just sends `/new` to a pane.\n   - Q: Should it be provider-agnostic or deleted?\n\n3. **empty pend directories**: Both have empty pend/ dirs (must-fix from s7t.10 review)\n\n## Consolidation options\n\n### Option A: Single skills/ with {self} templating\n```\nskills/\n  ask/SKILL.md.template  # uses {self}, {other}\n```\nInstaller generates provider-specific versions at install time.\n\n### Option B: Keep separate but auto-generate\nUse a single source and generate claude_skills/ + codex_skills/ during build.\n\n### Option C: Keep as-is\nMaintain separate directories; easier to customize per-provider if needed.\n\n## Questions to resolve\n1. Do any skills have genuinely different logic per provider (not just name substitution)?\n2. Is autonew useful in the simplified model?\n3. What's the installer impact of consolidation?\n\n## Verification\n- Review all skill pairs for differences beyond name substitution\n- Decide on autonew fate\n- Prototype consolidation if worthwhile","status":"open","priority":2,"issue_type":"task","owner":"stefanc@allenai.org","created_at":"2026-01-30T18:36:28.354496-08:00","created_by":"stefanc-ai2","updated_at":"2026-01-30T18:36:28.354496-08:00","labels":["refactor","simplification"],"dependencies":[{"issue_id":"claude_code_bridge-s7t.27","depends_on_id":"claude_code_bridge-s7t","type":"parent-child","created_at":"2026-01-30T18:36:28.360783-08:00","created_by":"stefanc-ai2"}]}
{"id":"claude_code_bridge-s7t.28","title":"Investigate multi-pair isolation (multiple Claude+Codex pairs per repo)","description":"Determine if it's possible to run multiple isolated (Claude+Codex) pairs in a single repo, where:\n- **Within a pair**: Claude can talk to Codex (and vice versa)\n- **Across pairs**: Pair A cannot communicate with Pair B\n\n## Use cases\n1. **Parallel workstreams**: Two developers working on different features in same repo\n2. **A/B testing**: Compare approaches with isolated AI pairs\n3. **CI/CD**: Multiple pipeline jobs with isolated AI assistants\n\n## Current architecture\n- Session files: `.ccb_config/.codex-session`, `.ccb_config/.claude-session`\n- Project isolation: `project_id.py` uses `.ccb_config` anchor\n- Pane discovery: Based on session files in project root\n\n## Design questions\n1. **Session namespacing**: Could use `CCB_PAIR_ID` or similar to namespace sessions?\n   - `.ccb_config/.codex-session.pair-1` vs `.ccb_config/.codex-session.pair-2`\n   \n2. **Pane isolation**: How to ensure `ask codex` from Pair A only reaches Pair A's Codex?\n   - Pane title markers: `CCB-pair1-codex` vs `CCB-pair2-codex`\n   - Session file filtering by pair ID\n\n3. **Launcher changes**: `ccb` would need `--pair-id` or similar flag\n   - `ccb --pair-id=1 codex,claude`\n   - `ccb --pair-id=2 codex,claude`\n\n4. **Environment propagation**: `CCB_PAIR_ID` must be inherited by spawned processes\n\n## Complexity assessment\n- Low: Just session file naming + env var\n- Medium: Pane discovery changes + launcher flags\n- High: Full multi-tenancy with access control\n\n## Notes\n- This is exploratory; may not be worth implementing\n- Current per-project isolation (repo A vs repo B) already provides some separation\n- Could be a post-simplification feature if there's demand","status":"open","priority":3,"issue_type":"task","owner":"stefanc@allenai.org","created_at":"2026-01-30T18:38:35.724099-08:00","created_by":"stefanc-ai2","updated_at":"2026-01-30T18:38:35.724099-08:00","labels":["exploration"],"dependencies":[{"issue_id":"claude_code_bridge-s7t.28","depends_on_id":"claude_code_bridge-s7t","type":"parent-child","created_at":"2026-01-30T18:38:35.724749-08:00","created_by":"stefanc-ai2"}]}
{"id":"claude_code_bridge-s7t.29","title":"Installer removes legacy provider commands from BIN_DIR","description":"Ensure deprecated provider-specific commands are removed from  (default ~/.local/bin) during install/uninstall.\\n\\n## Motivation\\nAfter removing cask/lask/gask/oask/dask and old *pend/*ping shims, existing installs may still have stale executables in ~/.local/bin.\\n\\n## Change\\n- Expand install.sh LEGACY_SCRIPTS to include: cask, lask, gask, oask, dask, gpend, opend, dpend, gping, oping, dping (keep cping/lping for now).\\n\\n## Verification\\n- install.sh install removes these names from BIN_DIR\\n- install.sh uninstall removes these names from BIN_DIR\\n- python -m compileall -q lib bin ccb test\\n- pytest","status":"closed","priority":2,"issue_type":"task","owner":"stefanc@allenai.org","created_at":"2026-01-30T18:59:03.676802-08:00","created_by":"stefanc-ai2","updated_at":"2026-01-30T18:59:31.297135-08:00","closed_at":"2026-01-30T18:59:31.297135-08:00","close_reason":"Expanded install.sh LEGACY_SCRIPTS so install/uninstall cleans old provider-specific executables from BIN_DIR","labels":["install","simplification"],"dependencies":[{"issue_id":"claude_code_bridge-s7t.29","depends_on_id":"claude_code_bridge-s7t","type":"parent-child","created_at":"2026-01-30T18:59:03.678678-08:00","created_by":"stefanc-ai2"}]}
{"id":"claude_code_bridge-s7t.3","title":"Delete Droid provider files","description":"Remove all Droid-related code from the codebase.\n\n## Files to DELETE\n- bin/dask, bin/daskd, bin/dpend, bin/dping\n- lib/daskd_daemon.py, lib/daskd_protocol.py, lib/daskd_session.py\n- lib/droid_comm.py\n- lib/askd/adapters/droid.py\n- droid_skills/ (entire directory)\n\n## Verification\n- pytest passes\n- No import errors","status":"closed","priority":1,"issue_type":"task","assignee":"stefanc-ai2","owner":"stefanc@allenai.org","created_at":"2026-01-30T12:38:58.896979-08:00","created_by":"stefanc-ai2","updated_at":"2026-01-30T14:45:00.54157-08:00","closed_at":"2026-01-30T14:45:00.54157-08:00","close_reason":"Deleted Droid provider files","labels":["provider-removal","simplification"],"dependencies":[{"issue_id":"claude_code_bridge-s7t.3","depends_on_id":"claude_code_bridge-s7t","type":"parent-child","created_at":"2026-01-30T12:38:58.897665-08:00","created_by":"stefanc-ai2"},{"issue_id":"claude_code_bridge-s7t.3","depends_on_id":"claude_code_bridge-s7t.4","type":"blocks","created_at":"2026-01-30T13:26:05.911778-08:00","created_by":"stefanc-ai2"}]}
{"id":"claude_code_bridge-s7t.30","title":"Post-askd cleanup: remove stale lib/askd artifacts","description":"Clean up leftover local artifacts after deleting askd.\\n\\n## Tasks\\n- Remove stale repo-checkout directory  (leftover __pycache__ + empty dirs after deleting askd sources).\\n- Update lingering test comment referencing askd.\\n\\n## Verification\\n- __pycache__\nadapters should fail\\n- \\n- ................................................................         [100%]\n64 passed in 0.56s\n\nüßπ Cleaning up session resources...\n‚úÖ Cleanup complete","status":"closed","priority":2,"issue_type":"task","owner":"stefanc@allenai.org","created_at":"2026-01-30T19:10:02.963867-08:00","created_by":"stefanc-ai2","updated_at":"2026-01-30T19:10:52.517452-08:00","closed_at":"2026-01-30T19:10:52.517452-08:00","close_reason":"Removed stale lib/askd checkout artifacts and updated lingering test comment","labels":["cleanup","simplification"],"dependencies":[{"issue_id":"claude_code_bridge-s7t.30","depends_on_id":"claude_code_bridge-s7t","type":"parent-child","created_at":"2026-01-30T19:10:02.965067-08:00","created_by":"stefanc-ai2"}]}
{"id":"claude_code_bridge-s7t.4","title":"Restrict providers to codex+claude","description":"Restrict all CLI surfaces and routing tables to only support `codex` and `claude`.\n\nGoal: once this lands, *nothing* should advertise or accept `gemini`, `opencode`, or `droid`.\n\n## Files to MODIFY (minimum)\n- `lib/providers.py`\n  - Remove `GASK_CLIENT_SPEC`, `OASK_CLIENT_SPEC`, `DASK_CLIENT_SPEC`\n- `lib/ccb_start_config.py`\n  - `DEFAULT_PROVIDERS = [\"codex\", \"claude\"]`\n  - Restrict allowed providers set to `{ \"codex\", \"claude\" }`\n- `bin/ask`\n  - Provider list + help output\n- `bin/askd`\n  - Only register Codex + Claude adapters\n- `bin/ping`\n  - Only support `codex` + `claude`\n- `bin/ccb-mounted`\n  - Only support `codex` + `claude`\n- `ccb`\n  - Remove provider-specific codepaths for gemini/opencode/droid\n  - Remove droid delegation command wiring (setup/test delegation)\n- `lib/askd/adapters/base.py`\n  - Update docstrings/comments to remove references to removed providers\n\n## Verification\n- `ask gemini \"hi\"` prints unknown provider\n- `ping opencode` prints unknown provider\n- `ccb codex,claude` starts successfully\n","status":"closed","priority":1,"issue_type":"task","assignee":"stefanc-ai2","owner":"stefanc@allenai.org","created_at":"2026-01-30T12:39:07.464458-08:00","created_by":"stefanc-ai2","updated_at":"2026-01-30T14:32:10.777515-08:00","closed_at":"2026-01-30T14:32:10.777515-08:00","close_reason":"Implemented: restrict providers to codex+claude (CLI + launcher)","labels":["provider-removal","simplification"],"dependencies":[{"issue_id":"claude_code_bridge-s7t.4","depends_on_id":"claude_code_bridge-s7t","type":"parent-child","created_at":"2026-01-30T12:39:07.465017-08:00","created_by":"stefanc-ai2"}]}
{"id":"claude_code_bridge-s7t.5","title":"Remove Windows/WSL compatibility from lib/","description":"Remove Windows and WSL-specific code from library modules.\n\n## Files to MODIFY\n\n**lib/terminal.py**\n- Remove _extract_wsl_path_from_unc_like_path()\n- Simplify _default_shell() to always return (\"bash\", \"-c\")\n\n**lib/compat.py** - Simplify to ~20 lines (no-op on Unix)\n\n**lib/ccb_config.py** - Remove WSL detection\n\n**lib/project_id.py** - Remove Windows drive path normalization\n\n## Verification\n- pytest passes on macOS/Linux","status":"closed","priority":2,"issue_type":"task","assignee":"stefanc-ai2","owner":"stefanc@allenai.org","created_at":"2026-01-30T12:39:41.336469-08:00","created_by":"stefanc-ai2","updated_at":"2026-01-30T15:21:29.506676-08:00","closed_at":"2026-01-30T15:21:29.506676-08:00","close_reason":"Removed Windows/WSL-specific logic from lib modules (compat, terminal, ccb_config, project_id) and updated tests.","labels":["platform","simplification"],"dependencies":[{"issue_id":"claude_code_bridge-s7t.5","depends_on_id":"claude_code_bridge-s7t","type":"parent-child","created_at":"2026-01-30T12:39:41.3371-08:00","created_by":"stefanc-ai2"}]}
{"id":"claude_code_bridge-s7t.6","title":"Remove Windows/WSL from ccb and bin scripts","description":"Remove Windows-specific code from main scripts.\n\n## Files to MODIFY\n- ccb - Remove Windows-specific subprocess handling, PowerShell paths\n- bin/ask - Remove Windows process creation flags\n\n## Verification\n- ccb codex,claude works on macOS/Linux\n- ask codex \"test\" works on macOS/Linux","status":"closed","priority":2,"issue_type":"task","assignee":"stefanc-ai2","owner":"stefanc@allenai.org","created_at":"2026-01-30T12:39:47.525845-08:00","created_by":"stefanc-ai2","updated_at":"2026-01-30T15:31:13.816404-08:00","closed_at":"2026-01-30T15:31:13.816404-08:00","close_reason":"Removed Windows/WSL-specific code paths from ccb and bin/ask; Unix-only behavior with tests passing.","labels":["platform","simplification"],"dependencies":[{"issue_id":"claude_code_bridge-s7t.6","depends_on_id":"claude_code_bridge-s7t","type":"parent-child","created_at":"2026-01-30T12:39:47.526393-08:00","created_by":"stefanc-ai2"},{"issue_id":"claude_code_bridge-s7t.6","depends_on_id":"claude_code_bridge-s7t.5","type":"blocks","created_at":"2026-01-30T12:39:51.662639-08:00","created_by":"stefanc-ai2"}]}
{"id":"claude_code_bridge-s7t.7","title":"Delete Windows install scripts","description":"Remove Windows installation support and Windows-only artifacts.\n\n## Files to DELETE\n- `install.ps1`\n- `install.cmd`\n- `bin/ccb-ping.cmd`\n- `**/SKILL.md.powershell` (all PowerShell skill variants)\n\n## Verification\n- `./install.sh install` still works on macOS/Linux\n- No references to Windows/PowerShell in the remaining install path (outside archived changelogs)\n","status":"closed","priority":2,"issue_type":"task","assignee":"stefanc-ai2","owner":"stefanc@allenai.org","created_at":"2026-01-30T12:39:57.198843-08:00","created_by":"stefanc-ai2","updated_at":"2026-01-30T15:09:39.175683-08:00","closed_at":"2026-01-30T15:09:39.175683-08:00","close_reason":"Deleted Windows-only install scripts/artifacts (install.ps1/install.cmd, cmd wrappers, PowerShell SKILL variants) and removed runtime references.","labels":["platform","simplification"],"dependencies":[{"issue_id":"claude_code_bridge-s7t.7","depends_on_id":"claude_code_bridge-s7t","type":"parent-child","created_at":"2026-01-30T12:39:57.19942-08:00","created_by":"stefanc-ai2"}]}
{"id":"claude_code_bridge-s7t.8","title":"Add --reply-to flag and response markers to protocol","description":"Add support for reply-via-ask correlation with a `--reply-to` flag and reply markers.\n\n## Protocol\nRequest (existing wrap style):\n```\nCCB_REQ_ID: \u003creq_id\u003e\n\n\u003cmessage\u003e\n\nCCB_DONE: \u003creq_id\u003e\n```\n\nResult/Reply (sent by callee):\n- Callee sends a result back via `ask \u003ccaller\u003e --reply-to=\u003creq_id\u003e ...`\n- `--reply-to` should default to a **result/notification** payload (i.e., do not wrap with ‚Äúend with CCB_DONE‚Äù instructions).\n\nExample payload:\n```\nCCB_REPLY: \u003coriginal_req_id\u003e\nCCB_FROM: \u003csender_provider\u003e\n[CCB_RESULT] No reply required.\n\n\u003canswer\u003e\n```\n\n## Files to MODIFY\n- `bin/ask`\n  - Add `--reply-to=\u003creq_id\u003e`\n  - When set, inject `CCB_REPLY:` and `CCB_FROM:` lines\n  - Make `--reply-to` imply `--no-wrap` (or equivalent) to avoid triggering a reply loop\n- `lib/ccb_protocol.py`\n  - Add marker constants: `REPLY_PREFIX = \"CCB_REPLY:\"`, `FROM_PREFIX = \"CCB_FROM:\"`\n\n## Verification\n- `ask claude --reply-to=\u003cid\u003e --no-wrap \"...\"` delivers a marked result message\n","status":"closed","priority":1,"issue_type":"task","assignee":"stefanc-ai2","owner":"stefanc@allenai.org","created_at":"2026-01-30T12:40:06.536844-08:00","created_by":"stefanc-ai2","updated_at":"2026-01-30T16:35:15.784074-08:00","closed_at":"2026-01-30T16:35:15.784074-08:00","close_reason":"Implemented --reply-to marker injection and protocol constants","labels":["async-ask","simplification"],"dependencies":[{"issue_id":"claude_code_bridge-s7t.8","depends_on_id":"claude_code_bridge-s7t","type":"parent-child","created_at":"2026-01-30T12:40:06.537389-08:00","created_by":"stefanc-ai2"}]}
{"id":"claude_code_bridge-s7t.9","title":"Make ask direct-send (no daemon / no polling)","description":"Make `ask` **submit-only** and **daemon-free** by sending directly to the target tmux/WezTerm pane.\n\n## Key principle\nCCB must not tail/monitor provider logs to fetch ‚Äúlatest result‚Äù. CCB must also avoid any blocking wait loops (sleep/poll) in the `ask` path.\n\nResults are delivered only via the interactive panes (human-visible) and the reply-via-ask pattern (when implemented).\n\n## Intended behavior\n- `ask \u003cprovider\u003e \u003cmessage\u003e` resolves the target provider session + pane, then `send_text()` directly via the terminal backend.\n- `ask` prints the generated `req_id` (for correlation / `--reply-to`) and exits immediately.\n- No `askd`, `caskd`, `laskd` requirement; no background shell scripts.\n\n## Files to MODIFY (minimum)\n- `bin/ask`\n  - Remove unified `askd` submission path and background/nohup script path\n  - Implement direct-send for `codex` and `claude`\n  - Always print `req_id` and exit (pure async)\n- `bin/ccb-mounted`\n  - Redefine ‚Äúmounted‚Äù as: active session file exists + pane is alive/reachable (no daemon ping)\n\n## Follow-ups (separate beads)\n- Delete `askd` code once `ask` no longer imports/uses it.\n- Delete provider-specific CLIs/daemons (`cask`, `lask`, `caskd`, `laskd`) once `ask` fully replaces them.\n\n## Verification\n- `ask codex \"hi\"` returns immediately with a `req_id` even if no daemon is running.\n- No log-tail style logic in the `ask` path:\n  - `rg -n \"CodexLogReader|ClaudeLogReader|wait_for_event\\(|wait_for_events\\(|wait_for_message\\(\" bin/ask` returns nothing\n","status":"closed","priority":1,"issue_type":"task","assignee":"stefanc-ai2","owner":"stefanc@allenai.org","created_at":"2026-01-30T12:40:20.127462-08:00","created_by":"stefanc-ai2","updated_at":"2026-01-30T16:41:04.600789-08:00","closed_at":"2026-01-30T16:41:04.600789-08:00","close_reason":"ask now sends directly to tmux/wezterm panes; ccb-mounted no longer pings daemons","labels":["async-ask","simplification"],"dependencies":[{"issue_id":"claude_code_bridge-s7t.9","depends_on_id":"claude_code_bridge-s7t","type":"parent-child","created_at":"2026-01-30T12:40:20.128061-08:00","created_by":"stefanc-ai2"},{"issue_id":"claude_code_bridge-s7t.9","depends_on_id":"claude_code_bridge-s7t.8","type":"blocks","created_at":"2026-01-30T12:40:24.245544-08:00","created_by":"stefanc-ai2"}]}
{"id":"claude_code_bridge-zjc","title":"Robustness: eliminate hangs, stale state, and lock races","description":"Epic for CCB robustness improvements.\n\n## Scope\n1. RPC timeouts + deadline propagation (Critical)\n2. Atomic state writes + validation helper (Critical)\n3. Lock robustness - TOCTOU, FD leaks (Critical)\n4. Stale state detection - TTL, pid checks (High)\n5. Replace bare exception handlers (High)\n\n## Success Criteria\n- No socket operations can hang indefinitely\n- State file writes are atomic and validated\n- Lock acquisition is race-free\n- Stale sessions are detected and cleaned up\n- Exceptions are typed and debuggable","status":"open","priority":1,"issue_type":"epic","owner":"stefanc@allenai.org","created_at":"2026-01-30T02:00:55.030591-08:00","created_by":"stefanc-ai2","updated_at":"2026-01-30T02:00:55.030591-08:00","labels":["robustness"]}
{"id":"claude_code_bridge-zjc.1","title":"RPC: add per-recv timeouts + request deadlines","description":"Add hard timeouts to all RPC/socket I/O to prevent indefinite hangs.\n\n## Files\n- lib/askd_client.py\n- lib/askd_rpc.py\n- bin/ask\n\n## Implementation\n- Add socket.settimeout() for all recv operations\n- Implement deadline propagation (pass timeout_s down call stack)\n- Wrap decode loops with deadline checks\n- Surface single timeout error type (CCBTimeoutError)\n\n## Acceptance Criteria\n- [ ] Every connect/send/recv has bounded timeout\n- [ ] Global request deadline prevents partial-read hangs\n- [ ] Consistent timeout error type surfaced to callers\n- [ ] Tests for timeout scenarios","status":"closed","priority":1,"issue_type":"task","owner":"stefanc@allenai.org","created_at":"2026-01-30T02:01:14.590972-08:00","created_by":"stefanc-ai2","updated_at":"2026-01-30T02:12:48.317422-08:00","closed_at":"2026-01-30T02:12:48.317424-08:00","labels":["quick-win","robustness","rpc"],"dependencies":[{"issue_id":"claude_code_bridge-zjc.1","depends_on_id":"claude_code_bridge-zjc","type":"parent-child","created_at":"2026-01-30T02:01:14.59182-08:00","created_by":"stefanc-ai2"}]}
{"id":"claude_code_bridge-zjc.2","title":"State: atomic writes + JSON validation helper","description":"Make session/state writes atomic and add validation.\n\n## Files\n- lib/session_utils.py\n- lib/pane_registry.py\n- daemon state writers\n\n## Implementation\n- Standardize: temp file ‚Üí fsync ‚Üí os.replace ‚Üí chmod(0o600)\n- Create read_json_state(path, schema=None) helper\n- Add minimal schema validation for required keys/types\n- Replace scattered json.loads() with validated reads\n\n## Acceptance Criteria\n- [ ] All state writes use atomic pattern\n- [ ] Validation helper with schema support\n- [ ] File permissions hardened (0o600)\n- [ ] Tests for concurrent write scenarios","status":"open","priority":1,"issue_type":"task","owner":"stefanc@allenai.org","created_at":"2026-01-30T02:01:14.779267-08:00","created_by":"stefanc-ai2","updated_at":"2026-01-30T02:01:14.779267-08:00","labels":["quick-win","robustness","state"],"dependencies":[{"issue_id":"claude_code_bridge-zjc.2","depends_on_id":"claude_code_bridge-zjc","type":"parent-child","created_at":"2026-01-30T02:01:14.779771-08:00","created_by":"stefanc-ai2"}]}
{"id":"claude_code_bridge-zjc.3","title":"Locks: fix TOCTOU + FD leaks; add contention tests","description":"Eliminate TOCTOU races and FD leaks in lock implementation.\n\n## Files\n- lib/process_lock.py\n\n## Implementation\n- Use single open FD with O_CLOEXEC, always closed on retry/failure\n- Rely on OS primitives (exclusive create / flock) not check-then-create\n- Add contention tests: multiple processes competing for same lock\n\n## Acceptance Criteria\n- [ ] No TOCTOU window in lock acquisition\n- [ ] No FD leaks on retry/failure paths\n- [ ] Tests: one winner, no leaked FDs, bounded wait, cleanup on crash\n- [ ] Works correctly on Windows and Unix","status":"open","priority":1,"issue_type":"task","owner":"stefanc@allenai.org","created_at":"2026-01-30T02:01:14.976308-08:00","created_by":"stefanc-ai2","updated_at":"2026-01-30T02:01:14.976308-08:00","labels":["locks","refactor","robustness"],"dependencies":[{"issue_id":"claude_code_bridge-zjc.3","depends_on_id":"claude_code_bridge-zjc","type":"parent-child","created_at":"2026-01-30T02:01:14.976845-08:00","created_by":"stefanc-ai2"}]}
{"id":"claude_code_bridge-zjc.4","title":"Registry: stale detection (TTL, pid checks, self-heal)","description":"Add stale state detection and isolation tightening.\n\n## Files\n- lib/pane_registry.py\n- lib/claude_comm.py\n- state readers\n\n## Implementation\n- Add owner identity fields: created_at, last_seen_at, pid, instance token\n- Verify pid is alive on read (best-effort)\n- Check timestamps within TTL, project key matches normalized workdir\n- Provide --cleanup and self-heal paths\n\n## Acceptance Criteria\n- [ ] Stale sessions detected by TTL and pid checks\n- [ ] Invalid/stale state ignored and regenerated\n- [ ] Self-heal path for corrupted state\n- [ ] Tests for stale state scenarios","status":"open","priority":2,"issue_type":"task","owner":"stefanc@allenai.org","created_at":"2026-01-30T02:01:29.98364-08:00","created_by":"stefanc-ai2","updated_at":"2026-01-30T02:01:29.98364-08:00","labels":["registry","robustness","state"],"dependencies":[{"issue_id":"claude_code_bridge-zjc.4","depends_on_id":"claude_code_bridge-zjc","type":"parent-child","created_at":"2026-01-30T02:01:29.984208-08:00","created_by":"stefanc-ai2"},{"issue_id":"claude_code_bridge-zjc.4","depends_on_id":"claude_code_bridge-zjc.2","type":"blocked-by","created_at":"2026-01-30T02:01:29.985189-08:00","created_by":"stefanc-ai2"}]}
{"id":"claude_code_bridge-zjc.5","title":"Errors: replace bare excepts; add debug diagnostics","description":"Systematically replace bare exception handlers with typed handling.\n\n## Scope\n~352 bare except handlers across ~42 files\n\n## Implementation\n- Triage into categories: file I/O, JSON parsing, subprocess, sockets\n- Replace with narrow exception types\n- When CCB_DEBUG=1, emit structured diagnostics to stderr/log\n- Make recovery behavior intentional and debuggable\n\n## Acceptance Criteria\n- [ ] No bare except: or except Exception: without justification\n- [ ] CCB_DEBUG=1 shows structured error info\n- [ ] Recovery behavior is explicit and documented\n- [ ] Tests for error recovery paths","status":"open","priority":2,"issue_type":"task","owner":"stefanc@allenai.org","created_at":"2026-01-30T02:01:30.174492-08:00","created_by":"stefanc-ai2","updated_at":"2026-01-30T02:01:30.174492-08:00","labels":["errors","observability","refactor","robustness"],"dependencies":[{"issue_id":"claude_code_bridge-zjc.5","depends_on_id":"claude_code_bridge-zjc","type":"parent-child","created_at":"2026-01-30T02:01:30.175038-08:00","created_by":"stefanc-ai2"}]}
